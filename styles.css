:root{
  /* メインカラー */
  --bg:#f5f7fb;
  --card:#ffffff;
  --muted:#6b7280;
  --accent:#0ea5e9; /* 明るい水色 */
  
  /* UI要素 */
  --control-bg:#f8fafc;
  --control-border:#e2e8f0;
  --input-border:#eef3fb;
  --input-focus:#818cf8;
  --btn-shadow:0 2px 4px rgba(79,70,229,0.12);
  --btn-hover-shadow:0 4px 8px rgba(79,70,229,0.2);
  
  /* 基本設定 */
  --radius:12px;
  --radius-sm:8px;
  --shadow:0 8px 30px rgba(15,23,42,0.06);
  --shadow-sm:0 2px 8px rgba(0,0,0,0.04);
  
  font-family: "Inter", "Noto Sans JP", system-ui, -apple-system, "Hiragino Kaku Gothic ProN", "Yu Gothic", "Segoe UI", Roboto, Arial;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:#0f172a;
  -webkit-font-smoothing:antialiased;
}
.container{
  max-width:980px;
  margin:36px auto;
  padding:20px;
}
.card{
  background:var(--card);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:16px;
  margin-bottom:18px;
}
.site-header{display:flex;justify-content:space-between;align-items:center}
.site-header h1{margin:0;font-size:1.3rem}
.subtitle{margin:6px 0 0;color:var(--muted);font-size:0.95rem}
.header-right .small-label{color:var(--muted);font-size:12px}
.header-right{display:flex;flex-direction:column;align-items:flex-end;gap:4px}
.version-label{color:var(--muted);font-size:12px;font-weight:bold;background:#f1f5f9;padding:2px 6px;border-radius:4px}

.controls .row{display:flex;gap:12px;align-items:flex-start;margin-bottom:12px;flex-wrap:wrap}
.controls input, .controls select{
  padding: 8px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--input-border);
  background: transparent;
  min-width: 180px;
  transition: all 0.2s ease;
}

.controls input:focus, .controls select:focus {
  border-color: var(--input-focus);
  outline: none;
  box-shadow: 0 0 0 3px rgba(129,140,248,0.1);
}

.controls .small{gap:16px}

/* テンプレートコントロール用スタイル */
.template-controls {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px;
  background: var(--control-bg);
  border: 1px solid var(--control-border);
  border-radius: var(--radius);
  box-shadow: var(--shadow-sm);
}

.template-actions {
  display: flex;
  gap: 12px;
  align-items: center;
}

.template-share {
  display: flex;
  gap: 16px;
  align-items: flex-start;
}

.share-url-group {
  flex: 1;
  display: flex;
  gap: 8px;
  align-items: center;
}

.share-url-group input {
  flex: 1;
  min-width: 240px;
}

.qr-group {
  display: flex;
  gap: 8px;
  align-items: center;
}

.btn-group {
  display: flex;
  gap: 4px;
}

#templateQR {
  display: none;
  width: 88px;
  height: 88px;
  border-radius: var(--radius-sm);
  object-fit: contain;
  border: 1px solid var(--control-border);
  padding: 8px;
  background: var(--card);
  box-shadow: var(--shadow-sm);
  transition: all 0.2s ease;
}

#templateQR:hover {
  transform: scale(1.02);
  box-shadow: var(--shadow);
}
.btn{
  background: var(--accent);
  border: none;
  color: white;
  padding: 8px 12px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  box-shadow: var(--btn-shadow);
  transition: all 0.2s ease;
  font-size: 0.9rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Ensure the tests grid takes a full row in the controls area so tiles are visible */
#testsGrid{flex-basis:100%;width:100%}

.btn:hover {
  opacity: 0.95;
  transform: translateY(-1px);
  box-shadow: var(--btn-hover-shadow);
}

.btn:active {
  transform: translateY(1px);
  box-shadow: var(--btn-shadow);
}

.btn.danger {
  background: #dc2626;
}

.scoreboard .score-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.totals{display:flex;gap:18px;color:var(--muted)}
.score-table{width:100%;border-collapse:collapse}
.score-table th, .score-table td{padding:10px;text-align:left;border-bottom:1px solid #f1f5f9}
.score-table input{width:100px;padding:6px;border-radius:8px;border:1px solid #eef3fb}
.add-subject{display:flex;gap:8px;margin-top:12px;align-items:center}
.add-subject input{padding:8px;border-radius:8px;border:1px solid #eef3fb}

.tiny{font-size:12px;color:var(--muted);padding:10px}
.action-btn {
  background: transparent;
  border: none;
  color: var(--accent);
  cursor: pointer;
  padding: 6px 10px;
  border-radius: var(--radius-sm);
  font-size: 0.9rem;
  transition: background 0.2s ease;
}

.action-btn:hover {
  background: rgba(79,70,229,0.08);
}
.delta-up{color:#16a34a}
.delta-down{color:#ef4444}
@media(max-width:680px){
  .controls .row{flex-direction:column;align-items:stretch}
  .add-subject{flex-direction:column;align-items:stretch}
}

/* Chart styles */
.chart-card{margin-top:18px}
.chart-title{margin:0 0 8px;font-size:1rem}
#scoreChart{width:100%;height:260px;border-radius:8px;background:linear-gradient(180deg, #ffffff, #fbfdff);box-shadow:0 6px 16px rgba(15,23,42,0.04)}
.chart-legend{display:flex;gap:12px;margin-top:8px;align-items:center}
.legend-item{color:var(--muted);font-size:13px}
.swatch{display:inline-block;width:16px;height:10px;border-radius:4px;margin-right:6px;vertical-align:middle}
.swatch.current{background:linear-gradient(90deg,#60a5fa,#6ee7b7)}
.swatch.previous{background:#cbd5e1}

/* Compare styles */
.compare-card{margin-top:18px}
.compare-controls{display:flex;gap:12px;align-items:flex-start}
#pasteShared{flex:1;min-height:80px;padding:8px;border:1px solid #eef3fb;border-radius:8px;font-family:monospace}
.compare-actions{display:flex;flex-direction:column;gap:8px}
.compare-actions .btn{min-width:140px}
#compareResult{margin-top:12px}
.compare-table{width:100%;border-collapse:collapse}
.compare-table th,.compare-table td{padding:8px;border-bottom:1px solid #f1f5f9;text-align:left}
.compare-summary{display:flex;gap:18px;color:var(--muted);margin-top:8px}
.badge{display:inline-block;padding:4px 8px;border-radius:8px;background:#f1f5f9;color:#0f172a}

/* Username modal */
.modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.5);display:flex;align-items:center;justify-content:center;z-index:40}
.modal{background:var(--card);padding:20px;border-radius:12px;box-shadow:var(--shadow);width:92%;max-width:420px}
.modal h3{margin:0 0 8px}
.modal input{width:100%;padding:10px;border-radius:8px;border:1px solid #eef3fb;margin-bottom:10px}
.modal .row{display:flex;gap:8px;justify-content:flex-end}

/* 公開ディレクトリページのスタイル */
.features h2{margin:0 0 16px;font-size:1.2rem}
.features ul{margin:0;padding:0;list-style:none}
.features li{margin-bottom:12px;font-weight:bold}
.feature-detail{
  font-weight:normal;
  color:var(--muted);
  font-size:0.9rem;
  margin-top:2px
}
footer.tiny ul{
  margin:4px 0;
  padding-left:20px;
  color:var(--muted);
  font-size:12px
}
#dirList ul{
  list-style:none;
  margin:0;
  padding:0
}
#dirList .subtitle{
  display:block;
  margin-top:4px
}

/* Template QR styling (small inline) */
#templateQR{width:88px;height:88px;border-radius:8px;object-fit:contain;border:1px solid #eef3fb;padding:6px;background:#fff}

/* Tests tile grid - use auto-fit for robust responsive layout */
.tests-grid, #testsGrid{
  display: grid;
  gap: 12px;
  margin-top: 8px;
  /* Responsive columns: each tile is at least 220px, grow to fill space */
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  align-items: start;
}
.test-tile{
  /* osu!lazer風のネオンタイル */
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.06);
  padding: 16px;
  border-radius: 14px;
  box-shadow: 0 8px 30px rgba(14,165,233,0.06), inset 0 1px 0 rgba(255,255,255,0.02);
  cursor: pointer;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: flex-start;
  min-height: 92px;
  position: relative;
  overflow: hidden;
  color: #e6f7ff;
}
.test-tile:hover{transform:translateY(-6px);box-shadow:0 18px 50px rgba(14,165,233,0.14)}
.test-tile::before{
  content: '';
  position: absolute;
  left: -40%;
  top: -40%;
  width: 200%;
  height: 200%;
  background: linear-gradient(60deg, rgba(79,70,229,0.06), rgba(62,130,255,0.04), rgba(110,231,183,0.02));
  transform: rotate(12deg);
  pointer-events: none;
}
.test-tile .tile-name{font-weight:800;margin-bottom:6px;color:#eaf6ff}
.test-tile .tile-meta{color:rgba(234,246,255,0.7);font-size:0.9rem}

/* Study / Test card — override inline styles to apply futuristic look */
#studyCard, #testCard{
  background: linear-gradient(180deg,#071226 0%, #041422 100%) !important;
  color: #e6f7ff !important;
  border-radius: 12px !important;
  box-shadow: 0 24px 60px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02) !important;
  border: 1px solid rgba(79,70,229,0.14) !important;
  min-height: calc(100vh - 220px) !important;
  padding: 28px !important;
  display:flex !important; flex-direction:column !important; justify-content:center !important; align-items:center !important;
}

/* Large front text */
#studyFront, #testFront{ font-weight:800; color:#f8fbff; font-size:2.4rem }
#studyBack{ color: rgba(234,246,255,0.8); font-size:1.2rem }

/* Inputs / blanks styling */
.mem-blank{ display:inline-block; min-width:120px; padding:8px 12px; border-radius:10px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px dashed rgba(234,246,255,0.08); color:rgba(234,246,255,0.7); }
.mem-input{ background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); color:#eaf6ff; padding:10px 12px; border-radius:10px; }

/* Feedback overlay (big emoji) */
#feedbackOverlay{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:9999; pointer-events:none }
#feedbackOverlay #feedbackEmoji{ font-size:8rem; filter: drop-shadow(0 20px 40px rgba(2,6,23,0.6)); transform:translateY(-8px); }

/* Buttons: neon style */
.btn{ background: linear-gradient(90deg,#60a5fa,#6ee7b7); color:#04263a; font-weight:700; box-shadow: 0 8px 30px rgba(62,130,255,0.12); border: 1px solid rgba(255,255,255,0.06); }
.btn.danger{ background: linear-gradient(90deg,#fb7185,#ef4444); color:#fff }

/* subtle animated highlight sweep */
.test-tile::after{
  content:''; position:absolute; left:-60%; top:0; width:40%; height:100%; background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.08), rgba(255,255,255,0.02)); transform:skewX(-18deg); transition: all 0.6s ease; opacity:0;
}
.test-tile:hover::after{ left:120%; opacity:1; transition: all 0.9s ease; }

/* make overall container slightly darker to emphasize neon */
.container{ background: linear-gradient(180deg, rgba(6,12,28,0.02), rgba(6,12,28,0.01)); }

@media(max-width:680px){
  .test-tile{ min-height:84px; padding:12px }
  #studyFront, #testFront{ font-size:1.6rem }
}

/* Keyframes and utility animations */
@keyframes neonPulse {
  0%{ box-shadow: 0 6px 20px rgba(62,130,255,0.06), 0 0 0 rgba(62,130,255,0); }
  50%{ box-shadow: 0 18px 40px rgba(62,130,255,0.14), 0 0 30px rgba(110,231,183,0.06); }
  100%{ box-shadow: 0 6px 20px rgba(62,130,255,0.06), 0 0 0 rgba(62,130,255,0); }
}

@keyframes sweepGlare {
  0%{ transform: translateX(-120%) skewX(-18deg); opacity: 0 }
  50%{ opacity: 0.9 }
  100%{ transform: translateX(120%) skewX(-18deg); opacity: 0 }
}

@keyframes cardPop {
  0%{ transform: translateY(14px) scale(0.98); opacity:0 }
  60%{ transform: translateY(-6px) scale(1.02); opacity:1 }
  100%{ transform: translateY(0) scale(1); opacity:1 }
}

@keyframes overlayPulse {
  0%{ transform: scale(0.9); opacity:0 }
  50%{ transform: scale(1.05); opacity:1 }
  100%{ transform: scale(1); opacity:1 }
}

/* Hover and press states using animations */
.test-tile.tile-hover{ animation: neonPulse 2.2s ease-in-out infinite; }
.test-tile.tile-press{ transform: scale(0.96); transition: transform 160ms ease; box-shadow: 0 28px 60px rgba(62,130,255,0.18); }
.test-tile.tile-press::after{ animation: sweepGlare 900ms ease forwards; }

/* Card appear/transition */
.card-appear{ animation: cardPop 420ms cubic-bezier(.22,1,.36,1) both; }

/* Feedback overlay show */
.feedback-show{ display:flex !important; animation: overlayPulse 420ms cubic-bezier(.2,.9,.2,1); }


/* Top actions bar (template/share/publish) */
.top-actions{display:flex;gap:12px;align-items:center;flex-wrap:nowrap;overflow-x:auto;padding:12px}
.top-actions .template-actions, .top-actions .share-actions, .top-actions .publish-actions{display:flex;gap:8px;align-items:center}
.top-actions select, .top-actions input{padding:8px;border-radius:8px;border:1px solid var(--input-border);background:transparent}
.top-actions .btn{height:38px;padding:6px 10px;display:inline-flex;align-items:center;justify-content:center}
.top-actions .btn-group{display:flex;gap:6px}

/* Ensure inputs don't wrap into vertical text; allow horizontal scroll on small screens */
.top-actions input[readonly]{min-width:200px}
